<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Propagate parameter uncertainty of TPC fits using bootstrap with residual resampling — predict_curves • mappestRisk</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Propagate parameter uncertainty of TPC fits using bootstrap with residual resampling — predict_curves"><meta name="description" content="Propagate parameter uncertainty of TPC fits using bootstrap with residual resampling"><meta property="og:description" content="Propagate parameter uncertainty of TPC fits using bootstrap with residual resampling"><meta property="og:image" content="https://ecologyr.github.io/mappestRisk/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mappestRisk</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/tpcs-model-fitting.html">TPCs model fitting</a></li>
    <li><a class="dropdown-item" href="../articles/tpcs-simulate-bootstrap.html">Simulate TPCs with bootstrap to propagate uncertainty</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EcologyR/mappestRisk/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Propagate parameter uncertainty of TPC fits using bootstrap with residual resampling</h1>
      <small class="dont-index">Source: <a href="https://github.com/EcologyR/mappestRisk/blob/main/R/predict_curves.R" class="external-link"><code>R/predict_curves.R</code></a></small>
      <div class="d-none name"><code>predict_curves.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Propagate parameter uncertainty of TPC fits using bootstrap with residual resampling</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">predict_curves</span><span class="op">(</span></span>
<span>  temp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dev_rate <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fitted_parameters <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  model_name_2boot <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  propagate_uncertainty <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_boots_samples <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="source">Source<a class="anchor" aria-label="anchor" href="#source"></a></h2>
    <p>The dataset used in the example was originally published in Satar &amp; Yokomi (2022)
under the CC-BY-NC license</p>
    </div>
    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-temp">temp<a class="anchor" aria-label="anchor" href="#arg-temp"></a></dt>
<dd><p>a vector of temperatures used in the experiment.
It should have at least four different temperatures and must contain only numbers
without any missing values.</p></dd>


<dt id="arg-dev-rate">dev_rate<a class="anchor" aria-label="anchor" href="#arg-dev-rate"></a></dt>
<dd><p>a vector of estimated development rates corresponding to each temperature.
These rates are calculated as the inverse of the number of days to complete the transition
from the beginning of a certain life stage to the beginning of the following at each temperature.
It must be numeric and of the same length as <code>temp</code>.</p></dd>


<dt id="arg-fitted-parameters">fitted_parameters<a class="anchor" aria-label="anchor" href="#arg-fitted-parameters"></a></dt>
<dd><p>a <code>tibble</code> obtained with <code><a href="fit_devmodels.html">fit_devmodels()</a></code> function,
including parameter names, estimates, standard errors, AICs, and <nls> objects
(fitted_models) using the <code><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html" class="external-link">nls.multstart::nls_multstart()</a></code> approach.</nls></p></dd>


<dt id="arg-model-name-boot">model_name_2boot<a class="anchor" aria-label="anchor" href="#arg-model-name-boot"></a></dt>
<dd><p>A vector of strings including one or several TPC models
fitted by <code><a href="fit_devmodels.html">fit_devmodels()</a></code>. Contrarily to that function, <code>model_name_2boot = "all"</code>
is not allowed in this function due to the slow bootstrapping procedure.
We recommend applying this function only to a small pre-selection of models
(e.g., one to four) based on statistical and ecological criteria with the help
of <code><a href="plot_devmodels.html">plot_devmodels()</a></code> function.</p></dd>


<dt id="arg-propagate-uncertainty">propagate_uncertainty<a class="anchor" aria-label="anchor" href="#arg-propagate-uncertainty"></a></dt>
<dd><p>A logical argument that specifies whether to
propagate parameter uncertainty by bootstrap with residual resampling.
If <code>FALSE</code>, the function returns predictions from the fitted TPCs for the
selected model(s). If <code>TRUE</code>, bootstrap is applied using residual resampling
to obtain multiple TPCs as detailed in vignettes of the <code>rTPC</code> package.
Defaults to <code>TRUE</code>.</p></dd>


<dt id="arg-n-boots-samples">n_boots_samples<a class="anchor" aria-label="anchor" href="#arg-n-boots-samples"></a></dt>
<dd><p>Number of bootstrap resampling iterations (default is 100).
A larger number of iterations makes the resampling procedure more robust,
but typically 100 is sufficient for propagating parameter uncertainty,
as increasing <code>n_boots_samples</code> will increase computation time for predicting resampled TPCs.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A tibble object with as many curves (TPCs) as the number of iterations provided
in the <code>n_boots_samples</code> argument if <code>propagate_uncertainty = TRUE</code> minus the bootstrap samples that
could not be fitted (i.e., new nonlinear regression models did not converge for them).
Otherwise, it returns just one prediction TPC from model fit estimates.
Each resampled TPC consists of a collection of predictions for a set of temperatures
from <code>temp - 20</code> to <code>temp + 15</code> with a resolution of 0.1°C and a unique identifier
called <code>boots_iter</code>. In addition to the uncertainty TPCs, the estimated TPC
is also explicit in the output tibble.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Angilletta, M.J., (2006). Estimating and comparing thermal performance curves.
<i>J. Therm. Biol.</i> 31: 541-545. (for model selection in TPC framework)</p>
<p>Padfield, D., O'Sullivan, H. and Pawar, S. (2021). <i>rTPC</i> and <i>nls.multstart</i>:
A new pipeline to fit thermal performance curves in <code>R</code>. <i>Methods Ecol Evol</i>. 12: 1138-1143.</p>
<p>Rebaudo, F., Struelens, Q. and Dangles, O. (2018). Modelling temperature-dependent
development rate and phenology in arthropods: The <code>devRate</code> package for <code>R</code>.
<i>Methods Ecol Evol</i>. 9: 1144-1150.</p>
<p>Satar, S. and Yokomi, R. (2002). Effect of temperature and host on development
of <i>Brachycaudus schwartzi</i> (Homoptera: Aphididae).
<i>Ann. Entomol. Soc. Am.</i> 95: 597-602.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code>browseVignettes("rTPC")</code> for model names, start values searching workflows, and
bootstrapping procedures using both <code><a href="https://rdrr.io/pkg/rTPC/man/get_start_vals.html" class="external-link">rTPC::get_start_vals()</a></code> and <code><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html" class="external-link">nls.multstart::nls_multstart()</a></code></p>
<p><code><a href="fit_devmodels.html">fit_devmodels()</a></code> for fitting Thermal Performance Curves to development rate data,
which is in turn based on <code><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html" class="external-link">nls.multstart::nls_multstart()</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># interactive()</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"aphid"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fitted_tpcs</span> <span class="op">&lt;-</span> <span class="fu"><a href="fit_devmodels.html">fit_devmodels</a></span><span class="op">(</span>temp <span class="op">=</span> <span class="va">aphid</span><span class="op">$</span><span class="va">temperature</span>,</span></span>
<span class="r-in"><span>                             dev_rate <span class="op">=</span> <span class="va">aphid</span><span class="op">$</span><span class="va">rate_value</span>,</span></span>
<span class="r-in"><span>                             model_name <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_devmodels.html">plot_devmodels</a></span><span class="op">(</span>temp <span class="op">=</span> <span class="va">aphid</span><span class="op">$</span><span class="va">temperature</span>,</span></span>
<span class="r-in"><span>               dev_rate <span class="op">=</span> <span class="va">aphid</span><span class="op">$</span><span class="va">rate_value</span>,</span></span>
<span class="r-in"><span>               fitted_parameters <span class="op">=</span> <span class="va">fitted_tpcs</span>,</span></span>
<span class="r-in"><span>               species <span class="op">=</span> <span class="st">"Brachycaudus schwartzi"</span>,</span></span>
<span class="r-in"><span>               life_stage <span class="op">=</span> <span class="st">"Nymphs"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Obtain prediction TPCs with bootstraps for propagating uncertainty:</span></span></span>
<span class="r-in"><span><span class="va">boot_tpcs</span> <span class="op">&lt;-</span> <span class="fu">predict_curves</span><span class="op">(</span>temp <span class="op">=</span> <span class="va">aphid</span><span class="op">$</span><span class="va">temperature</span>,</span></span>
<span class="r-in"><span>                            dev_rate <span class="op">=</span> <span class="va">aphid</span><span class="op">$</span><span class="va">rate_value</span>,</span></span>
<span class="r-in"><span>                            fitted_parameters <span class="op">=</span> <span class="va">fitted_tpcs</span>,</span></span>
<span class="r-in"><span>                            model_name_2boot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lactin2"</span>, <span class="st">"briere2"</span>, <span class="st">"beta"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            propagate_uncertainty <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                            n_boots_samples <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">boot_tpcs</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Darío San-Segundo Molina, A. Márcia Barbosa, Antonio Jesús Pérez-Luque, Francisco Rodríguez-Sánchez.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

