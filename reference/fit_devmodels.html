<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit Thermal Performance Curves — fit_devmodels • mappestRisk</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit Thermal Performance Curves — fit_devmodels"><meta name="description" content="Fit nonlinear regression models to data representing how development rate changes
with temperature (known as Thermal Performance Curves), based on
nls.multstart::nls_multstart() approach to development rate data across temperatures.
The fitting procedure is built upon previous packages for starting values estimation,
namely rTPC and devRate."><meta property="og:description" content="Fit nonlinear regression models to data representing how development rate changes
with temperature (known as Thermal Performance Curves), based on
nls.multstart::nls_multstart() approach to development rate data across temperatures.
The fitting procedure is built upon previous packages for starting values estimation,
namely rTPC and devRate."><meta property="og:image" content="https://ecologyr.github.io/mappestRisk/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mappestRisk</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/generate-risk-maps.html">Generating Risk Maps</a></li>
    <li><a class="dropdown-item" href="../articles/tpcs-model-fitting.html">TPCs model fitting</a></li>
    <li><a class="dropdown-item" href="../articles/tpcs-simulate-bootstrap.html">Simulate TPCs with bootstrap to propagate uncertainty</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EcologyR/mappestRisk/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Fit Thermal Performance Curves</h1>
      <small class="dont-index">Source: <a href="https://github.com/EcologyR/mappestRisk/blob/main/R/fit_devmodels.R" class="external-link"><code>R/fit_devmodels.R</code></a></small>
      <div class="d-none name"><code>fit_devmodels.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fit nonlinear regression models to data representing how development rate changes
with temperature (known as Thermal Performance Curves), based on
<code><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html" class="external-link">nls.multstart::nls_multstart()</a></code> approach to development rate data across temperatures.
The fitting procedure is built upon previous packages for starting values estimation,
namely <code>rTPC</code> and <code>devRate</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_devmodels</span><span class="op">(</span>temp <span class="op">=</span> <span class="cn">NULL</span>, dev_rate <span class="op">=</span> <span class="cn">NULL</span>, model_name <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="source">Source<a class="anchor" aria-label="anchor" href="#source"></a></h2>
    <p>The dataset used in the example was originally published in Satar &amp; Yokomi (2022)
under the CC-BY-NC license.
The start values and equations for the 'briere1', 'lactin1', 'mod_polynomial'
and 'wang' models have been obtained from
the <a href="https://cran.r-project.org/package=devRate" class="external-link">devRate</a> package.</p>
    </div>
    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-temp">temp<a class="anchor" aria-label="anchor" href="#arg-temp"></a></dt>
<dd><p>a vector of temperatures used in the experiment.
It should have at least four different temperatures and must contain only numbers
without any missing values.</p></dd>


<dt id="arg-dev-rate">dev_rate<a class="anchor" aria-label="anchor" href="#arg-dev-rate"></a></dt>
<dd><p>a vector of estimated development rates corresponding to each temperature.
These rates are calculated as the inverse of the number of days to complete the transition
from the beginning of a certain life stage to the beginning of the following at each temperature.
It must be numeric and of the same length as <code>temp</code>.</p></dd>


<dt id="arg-model-name">model_name<a class="anchor" aria-label="anchor" href="#arg-model-name"></a></dt>
<dd><p>a string or a vector that specifies the model(s) to use for
fitting the Thermal Performance Curves. Options include "all" or specific
models listed in <a href="available_models.html">available_models</a>. These models typically exhibit a common unimodal, left-skewed shape.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A table in <code>tibble</code> format with estimates and standard errors
for each parameter of the models specified by the user that have adequately
converged. Models are sorted based on their Akaike Information Criterion (AIC) values,
with the best fitting models shown first. Fitted models are also provided in list format
in the <code>model_list</code> column and can be accessed using <code><a href="get_fitted_model.html">get_fitted_model()</a></code> for
for further inspection.
It is important to consider ecological criteria alongside statistical information.
For additional help in model selection,
we recommend using <code><a href="plot_devmodels.html">plot_devmodels()</a></code> and consulting relevant literature.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Angilletta, M.J., (2006). Estimating and comparing thermal performance curves.
<i>J. Therm. Biol.</i> 31: 541-545. (for model selection in TPC framework)</p>
<p>Padfield, D., O'Sullivan, H. and Pawar, S. (2021). <i>rTPC</i> and <i>nls.multstart</i>:
A new pipeline to fit thermal performance curves in <code>R</code>. <i>Methods Ecol Evol</i>. 12: 1138-1143.</p>
<p>Rebaudo, F., Struelens, Q. and Dangles, O. (2018). Modelling temperature-dependent
development rate and phenology in arthropods: The <code>devRate</code> package for <code>R</code>.
<i>Methods Ecol Evol</i>. 9: 1144-1150.</p>
<p>Satar, S. and Yokomi, R. (2002). Effect of temperature and host on development
of <i>Brachycaudus schwartzi</i> (Homoptera: Aphididae).
<i>Ann. Entomol. Soc. Am.</i> 95: 597-602.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html" class="external-link">nls.multstart::nls_multstart()</a></code> for structure of model fitting approach</p>
<p><code>browseVignettes("rTPC")</code> for model names, start values searching workflows and
bootstrapping procedures using both <code>rTPC</code> and <code>nls.multstart</code> packages.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"aphid"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fitted_tpcs</span> <span class="op">&lt;-</span> <span class="fu">fit_devmodels</span><span class="op">(</span>temp <span class="op">=</span> <span class="va">aphid</span><span class="op">$</span><span class="va">temperature</span>,</span></span>
<span class="r-in"><span>                             dev_rate <span class="op">=</span> <span class="va">aphid</span><span class="op">$</span><span class="va">rate_value</span>,</span></span>
<span class="r-in"><span>                             model_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lactin2"</span>, <span class="st">"briere2"</span>,</span></span>
<span class="r-in"><span>                                            <span class="st">"mod_weibull"</span><span class="op">)</span></span></span>
<span class="r-in"><span>                             <span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> fitting model lactin2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> fitting model briere2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> fitting model mod_weibull</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fitted_tpcs</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   model_name param_name start_vals param_est param_se model_AIC model_BIC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> lactin2    a               0.119    0.069<span style="text-decoration: underline;">2</span>   0.046<span style="text-decoration: underline;">3</span>     -<span style="color: #BB0000;">42.2</span>     -<span style="color: #BB0000;">42.5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> lactin2    b              -<span style="color: #BB0000;">0.254</span>   -<span style="color: #BB0000;">0.283</span>    0.402      -<span style="color: #BB0000;">42.2</span>     -<span style="color: #BB0000;">42.5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> lactin2    tmax           32.5     41.3      7.75       -<span style="color: #BB0000;">42.2</span>     -<span style="color: #BB0000;">42.5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> lactin2    delta_t         7.5     13.5      6.98       -<span style="color: #BB0000;">42.2</span>     -<span style="color: #BB0000;">42.5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> briere2    tmin           15       10.0      2.33       -<span style="color: #BB0000;">42.6</span>     -<span style="color: #BB0000;">42.9</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> briere2    tmax           32.5     36.5      3.40       -<span style="color: #BB0000;">42.6</span>     -<span style="color: #BB0000;">42.9</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1 more variable: model_fit &lt;list&gt;</span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Darío San-Segundo Molina, A. Márcia Barbosa, Antonio Jesús Pérez-Luque, Francisco Rodríguez-Sánchez.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

