<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>TPCs model fitting • mappestRisk</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="TPCs model fitting">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mappestRisk</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/tpcs-model-fitting.html">TPCs model fitting</a></li>
    <li><a class="dropdown-item" href="../articles/tpcs-simulate-bootstrap.html">Simulate TPCs with bootstrap to propagate uncertainty</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EcologyR/mappestRisk/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>TPCs model fitting</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/EcologyR/mappestRisk/blob/main/vignettes/articles/tpcs-model-fitting.Rmd" class="external-link"><code>vignettes/articles/tpcs-model-fitting.Rmd</code></a></small>
      <div class="d-none name"><code>tpcs-model-fitting.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="fit-a-thermal-performance-curve-tpc-to-your-data">Fit a thermal performance curve (TPC) to your data:<a class="anchor" aria-label="anchor" href="#fit-a-thermal-performance-curve-tpc-to-your-data"></a>
</h2>
<p>The Thermal Performance Curves can be understood as models describing
the nonlinear temperature dependence of several biological rates <span class="citation">(Amarasekare and Savage 2012)</span>. TPC shapes are
usually unimodal and left-skewed <span class="citation">(Huey and
Stevenson 1979)</span>, which is also the case for development rate TPCs
of insects <span class="citation">(Régnier, Legrand, and Rebaudo
2022)</span>. Fitting these nonlinear regression models requires to
incorporate <em>a priori</em> knowledge on model parameters. For that
purpose, the R packages <code>rTPC</code> <span class="citation">(Padfield, O’Sullivan, and Pawar 2021; Padfield,
O’Sullivan, and Windram 2025)</span>and <code>devRate</code><span class="citation">(Francois Rebaudo and Regnier 2025; François Rebaudo,
Struelens, and Dangles 2018)</span> have provided R functions and
workflows to facilitate model fitting, start values selection and
parameter calculation of TPCs. Additionally, <code>nls.multstart</code>
package <span class="citation">(Padfield, O’Sullivan, and Pawar 2021;
Padfield, Matheson, and Windram 2025)</span> provides a nonlinear,
least-squares framework to facilitate fitting these curves to
experimental data in a flexible and efficient manner.</p>
<p>However, we believe that most researchers obtaining experimental data
on rate development across temperatures may not have enough R
programming knowledge to accomplish repeteadly the model fitting
procedure in reproducible workflows. Aiming to facilitate the usage of
these previous contributions made by the above-mentioned R packages to
TPC modelling for a broad-audience among experimental researchers,
<code>mappestRisk</code> aims to synthesize these software development
into an unique function called <code><a href="../reference/fit_devmodels.html">fit_devmodels()</a></code>.</p>
<p>This function takes for input a <code>data.frame</code> or
<code>tibble</code> containing two numeric columns: one with temperature
data –with at least 4 unique temperature treatments– and the other with
development rate data. The user can select which models to fit among
those included in <code>available_models</code> (or use them all). Then,
for each model equation, the function will search for the most
appropriate start values data for performing nonlinear regression models
using <code><a href="https://rdrr.io/pkg/rTPC/man/get_start_vals.html" class="external-link">rTPC::get_start_vals()</a></code> when possible, or
alternatively <code>devRate</code> parameter data set for models not
included in the former package. Once selected, the function will also
search for lower and upper thermal limits when possible using
<code><a href="https://rdrr.io/pkg/rTPC/man/get_lower_lims.html" class="external-link">rTPC::get_lower_lims()</a></code> or
<code><a href="https://rdrr.io/pkg/rTPC/man/get_upper_lims.html" class="external-link">rTPC::get_upper_lims()</a></code>. Next, the function performs
sequentially the nonlinear least-squares regression models using
<code><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html" class="external-link">nls.multstart::nls_multstart()</a></code> function for each set of
model equation, start values and limits with default configuration of
<code>nls_multstart</code> approach (see function documentation here).
TPC models not achieving convergence are further discarded.</p>
<p>In this example, we’ll show how to fit one to several thermal
performance curves to a data set of development rate variation across
temperatures<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;At least 4 unique temperatures are required. Fore more
details, see documentation.&lt;/p&gt;"><sup>1</sup></a>. The following code provides an example as
given in <code><a href="../reference/fit_devmodels.html">fit_devmodels()</a></code> function documentation, with a
data table showing the output of fitted models.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"aphid"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fitted_tpcs_aphid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_devmodels.html">fit_devmodels</a></span><span class="op">(</span>temp <span class="op">=</span> <span class="va">aphid</span><span class="op">$</span><span class="va">temperature</span>,</span>
<span>                                   dev_rate <span class="op">=</span> <span class="va">aphid</span><span class="op">$</span><span class="va">rate_value</span>,</span>
<span>                                   model_name <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span>
<span><span class="co">#&gt; By default, all models are fitted except `ratkowsky`, `mod_polynomial` and `wang` due to</span></span>
<span><span class="co">#&gt; unrealistic behavior at some TPC regions. If you still want to fit them, please write all model names manually</span></span>
<span><span class="co">#&gt; fitting model beta</span></span>
<span><span class="co">#&gt; fitting model boatman</span></span>
<span><span class="co">#&gt; fitting model briere1</span></span>
<span><span class="co">#&gt; Poorly informative start values for briere1 model</span></span>
<span><span class="co">#&gt; fitting model briere2</span></span>
<span><span class="co">#&gt; fitting model joehnk</span></span>
<span><span class="co">#&gt; fitting model kamykowski</span></span>
<span><span class="co">#&gt; fitting model lactin1</span></span>
<span><span class="co">#&gt; fitting model lactin2</span></span>
<span><span class="co">#&gt; fitting model mod_weibull</span></span>
<span><span class="co">#&gt; fitting model oneill</span></span>
<span><span class="co">#&gt; fitting model pawar</span></span>
<span><span class="co">#&gt; fitting model schoolfield</span></span>
<span><span class="co">#&gt; fitting model thomas</span></span></code></pre></div>
<p>After running <code><a href="../reference/fit_devmodels.html">fit_devmodels()</a></code>, a <code>tibble</code> (a
specific case of <code>data.frame</code>) is created containing the most
relevant statistical information of the modelled TPCs: model name,
parameter information –name, estimates, standard error, AICs and listed
model objects.To continue the package workflow, this output must be
stored as an object (here we call it <code>fitted_tpcs_aphid</code>).
This <code>tibble</code> has the following aspect:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fitted_tpcs_aphid</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 53 × 8</span></span></span>
<span><span class="co">#&gt;    model_name param_name start_vals param_est    param_se model_AIC model_BIC</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> beta       a               0.145     0.143     0.006<span style="text-decoration: underline;">30</span>     -<span style="color: #BB0000;">43.0</span>     -<span style="color: #BB0000;">43.3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> beta       b              25        26.7       1.10        -<span style="color: #BB0000;">43.0</span>     -<span style="color: #BB0000;">43.3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> beta       c              25       202.    <span style="text-decoration: underline;">13</span>598.          -<span style="color: #BB0000;">43.0</span>     -<span style="color: #BB0000;">43.3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> beta       d               2       100     <span style="text-decoration: underline;">12</span>046.          -<span style="color: #BB0000;">43.0</span>     -<span style="color: #BB0000;">43.3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> beta       e               2        32.6    <span style="text-decoration: underline;">2</span>282.          -<span style="color: #BB0000;">43.0</span>     -<span style="color: #BB0000;">43.3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> boatman    rmax            0.145     0.142     0.006<span style="text-decoration: underline;">48</span>     -<span style="color: #BB0000;">42.4</span>     -<span style="color: #BB0000;">42.7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> boatman    tmin           15         0       104.          -<span style="color: #BB0000;">42.4</span>     -<span style="color: #BB0000;">42.7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> boatman    tmax           32.5      43.7      66.7         -<span style="color: #BB0000;">42.4</span>     -<span style="color: #BB0000;">42.7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> boatman    a               1.1       1.42      1.03        -<span style="color: #BB0000;">42.4</span>     -<span style="color: #BB0000;">42.7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> boatman    b               0.4       2.44     20.0         -<span style="color: #BB0000;">42.4</span>     -<span style="color: #BB0000;">42.7</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 43 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: model_fit &lt;list&gt;</span></span></span></code></pre></div>
<p>Despite the output yields a table with explicit statistical
information and model objects with implicit additional information,
selecting a model should better be guided by ecological, rather that
only statistical criteria. This typically involves visualising the
predictions of the fitted TPCs for further visual examination. A
potential user of the package may use their expertise on thermal biology
and ecology of the species to distinguish which of the fitted TPCs
accomplish to approximate true temperature-development relationships.
For example, a fitted TPC model yielding a critical thermal maximum
beyond 50ºC –i.e., with a right-side vertical x-axis cutoff– may not be
realistic, as most species do not encounter this temperatures.
Similarly, models yielding quasi-symmetric TPCs or unexpected behaviors
at some regions of the curve may also be further discarded. We strongly
believe there is no a straightforward statistical strategy to select
among TPC models; instead, comparing a large number of fitted TPCs with
expertise ecological criteria may improve biological realism of model
selection and reduce arbitrariety. Finally, accounting for the thermal
regimes that the species will likely encounter in the region of interest
to project risk may help select among curves by prioritizing curves with
specific expected behaviors in theTPC regions corresponding to these
thermal regimes.</p>
<p>The <code><a href="../reference/plot_devmodels.html">plot_devmodels()</a></code> function facilitates quick
visualizations of predictions of the Thermal Performance Curves to guide
model selection under ecological criteria. It takes as an input the
resulting <code>tibble</code>/<code>data.frame</code> stored as an
object from <code><a href="../reference/fit_devmodels.html">fit_devmodels()</a></code>. It has also arguments to title
and subtitle the figure with the species’ name and the life stage
evaluated, respectively. Since wrapped in the <code>ggplot2</code>
approach, customization is available by adding new lines with compatible
functions with <code>ggplot2</code>.</p>
<p>Following the previous example:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_devmodels.html">plot_devmodels</a></span><span class="op">(</span>temp <span class="op">=</span> <span class="va">aphid</span><span class="op">$</span><span class="va">temperature</span>,</span>
<span>               dev_rate <span class="op">=</span> <span class="va">aphid</span><span class="op">$</span><span class="va">rate_value</span>,</span>
<span>               fitted_parameters <span class="op">=</span> <span class="va">fitted_tpcs_aphid</span>,</span>
<span>               species <span class="op">=</span> <span class="st">"Brachycaudus schwartzi"</span>,</span>
<span>               life_stage <span class="op">=</span> <span class="st">"nymphs"</span><span class="op">)</span></span></code></pre></div>
<p><img src="tpcs-model-fitting_files/figure-html/unnamed-chunk-4-1.png" width="100%"></p>
<p>As you can see, the plot is faceted across TPC models included in
<code>fitted_tpcs_aphid</code>.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-amarasekare2012" class="csl-entry">
Amarasekare, Priyanga, and Van Savage. 2012. <span>“A framework for
elucidating the temperature dependence of fitness.”</span> <em>The
American Naturalist</em> 179 (2): 178–91. <a href="https://doi.org/10.1086/663677" class="external-link">https://doi.org/10.1086/663677</a>.
</div>
<div id="ref-huey1979" class="csl-entry">
Huey, Raymond, and Robert Stevenson. 1979. <span>“Integrating Thermal
Physiology and Ecology of Ectotherms: A Discussion of
Approaches.”</span> <em>American Zoologist</em> 19 (February). <a href="https://doi.org/10.1093/icb/19.1.357" class="external-link">https://doi.org/10.1093/icb/19.1.357</a>.
</div>
<div id="ref-nls.multstart" class="csl-entry">
Padfield, Daniel, Granville Matheson, and Francis Windram. 2025.
<span>“Nls.multstart: Robust Non-Linear Regression Using AIC
Scores.”</span> <a href="https://CRAN.R-project.org/package=nls.multstart" class="external-link">https://CRAN.R-project.org/package=nls.multstart</a>.
</div>
<div id="ref-padfield2021" class="csl-entry">
Padfield, Daniel, Hannah O’Sullivan, and Samraat Pawar. 2021.
<span>“rTPC and Nls.multstart: A New Pipeline to Fit Thermal Performance
Curves in r.”</span> <em>Methods in Ecology and Evolution</em> 12 (6):
1138–43. <a href="https://doi.org/10.1111/2041-210X.13585" class="external-link">https://doi.org/10.1111/2041-210X.13585</a>.
</div>
<div id="ref-rTPC" class="csl-entry">
Padfield, Daniel, Hannah O’Sullivan, and Francis Windram. 2025.
<span>“rTPC: Fitting and Analysing Thermal Performance Curves.”</span>
<a href="https://github.com/padpadpadpad/rTPC" class="external-link">https://github.com/padpadpadpad/rTPC</a>.
</div>
<div id="ref-devRate" class="csl-entry">
Rebaudo, Francois, and Baptiste Regnier. 2025. <span>“devRate: Quantify
the Relationship Between Development Rate and Temperature in
Ectotherms.”</span> <a href="https://CRAN.R-project.org/package=devRate" class="external-link">https://CRAN.R-project.org/package=devRate</a>.
</div>
<div id="ref-rebaudo2018" class="csl-entry">
Rebaudo, François, Quentin Struelens, and Olivier Dangles. 2018.
<span>“Modelling Temperature-Dependent Development Rate and Phenology in
Arthropods: The devRate Package for r.”</span> <em>Methods in Ecology
and Evolution</em> 9 (4): 1144–50. https://doi.org/<a href="https://doi.org/10.1111/2041-210X.12935" class="external-link">https://doi.org/10.1111/2041-210X.12935</a>.
</div>
<div id="ref-régnier2022" class="csl-entry">
Régnier, Baptiste, Judith Legrand, and François Rebaudo. 2022.
<span>“Modeling Temperature-Dependent Development Rate in Insects and
Implications of Experimental Design.”</span> <em>Environmental
Entomology</em> 51 (1): 132–44. <a href="https://doi.org/10.1093/ee/nvab115" class="external-link">https://doi.org/10.1093/ee/nvab115</a>.
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Darío San-Segundo Molina, A. Márcia Barbosa, Antonio Jesús Pérez-Luque, Francisco Rodríguez-Sánchez.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
